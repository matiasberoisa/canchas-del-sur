<html>

<head>
    <link rel="stylesheet" href="../css/canchasPartidos.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
        integrity="sha512-...." crossorigin="anonymous" />
    <link rel="icon" type="image/png" href="utils/images/logo.png">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />


</head>

<body>
    <header>
        <a href="../index.html"><img src="../utils/images/logo.png" alt="Canchas Del Sur Logo" id="logo"></a>
        <h1 id="tituloHeader"> <a href="../index.html">Canchas Del Sur</a></h1>
        <nav>
            <ul>
                <li><a href="../index.html#nosotrosInfo">Sobre Nosotros</a></li>
                <li><a href="../index.html#faq">FAQ</a></li>
                <li><a href="../index.html#contacto">Contacto</a></li>
                <li><a href="canchasCatalogo.html">Reserva tu cancha</a></li>
                <li><a href="canchasPartidos.html">Unirme</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <div id="map"></div>
        <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

        <script>
            window.onload = function () {
                if (!navigator.geolocation) {
                    alert("Tu navegador no soporta geolocalización");
                    return;
                }

                navigator.geolocation.getCurrentPosition(
                    (pos) => {
                        const lat = pos.coords.latitude;
                        const lon = pos.coords.longitude;

                        const map = L.map("map").setView([lat, lon], 14);

                        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
                            maxZoom: 19,
                            attribution: '&copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a>'
                        }).addTo(map);

                        L.marker([lat, lon]).addTo(map).bindPopup("Estás aquí").openPopup();

                        const radius = 5000;
                        L.circle([lat, lon], {
                            radius: radius,
                            color: "blue",
                            fillColor: "#3f99ff",
                            fillOpacity: 0.2
                        }).addTo(map);

                        const partidos = [
                            {
                                nombre: "Partido 1",
                                lat: lat + 0.02,
                                lon: lon + 0.01,
                                cancha: "Complejo El Sur",
                                integrantes: 7,
                                horario: "21:00 hs",
                            },
                            {
                                nombre: "Partido 2",
                                lat: lat - 0.015,
                                lon: lon - 0.005,
                                cancha: "Fútbol City",
                                integrantes: 9,
                                horario: "19:30 hs",
                            },
                            {
                                nombre: "Partido 3",
                                lat: lat + 0.03,
                                lon: lon - 0.01,
                                cancha: "Cancha Norte",
                                integrantes: 5,
                                horario: "22:00 hs",
                            },
                        ];


                        partidos.forEach((p) => {
                            const distancia = map.distance([lat, lon], [p.lat, p.lon]);
                            if (distancia <= radius) {
                                const popupContent = `
      <div style="
        width: 220px;
        padding: 10px;
        border-radius: 10px;
        background: #fff;
        box-shadow: 0 2px 6px rgba(0,0,0,0.3);
        font-family: sans-serif;
      ">
        <h3 style="margin: 0; font-size: 16px; color: #2a7ae2;">${p.nombre}</h3>
        <p style="margin: 5px 0;"><strong>Cancha:</strong> ${p.cancha}</p>
        <p style="margin: 5px 0;"><strong>Integrantes:</strong> ${p.integrantes}/10</p>
        <p style="margin: 5px 0;"><strong>Horario:</strong> ${p.horario}</p>
        <button style="
          background: #2a7ae2;
          color: white;
          border: none;
          border-radius: 6px;
          padding: 6px 10px;
          cursor: pointer;
          margin-top: 6px;
        ">Unirme</button>
      </div>
    `;

                                L.marker([p.lat, p.lon])
                                    .addTo(map)
                                    .bindPopup(popupContent, { maxWidth: 240 });
                            }
                        });

                    },
                    (err) => {
                        alert("No se pudo obtener la ubicación: " + err.message);
                    }
                );
            };
        </script>
    </main>
    <footer>
        <p>&copy;
            2023 Canchas del Sur</p>
    </footer>
</body>

</html>